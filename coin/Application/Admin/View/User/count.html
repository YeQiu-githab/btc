<include file="Public:header"/>
<div id="main-content">
    <div id="top-alert" class="fixed alert alert-error" style="display: none;">
        <button class="close fixed" style="margin-top: 4px;">&times;</button>
        <div class="alert-content">警告内容</div>
    </div>
    <div id="main" class="main">
        <div class="main-title-h">
            <span class="h1-title">团队统计</span>
            <div class="fr">
                <button class="btn btn-warning" onClick="location.href='{:U('User/count')}'">初始化搜索</button>
            </div>
        </div>
        <div class="cf">
            <div class="search-form fr cf">
                <div class="sleft">
                    <form name="formSearch" id="formSearch" method="get" name="form1">
                        <dev id="test-range">
                            开始时间:
                            <input id="start_time" type="text" name="start_time" class="search-input form-control" value="{$Think.get.start_time}"  style="" placeholder="开始日期">
                            到:  <input  id="end_time" type="text" name="end_time" class="search-input form-control" value="{$Think.get.end_time}"  style="" placeholder="结束日期">
                        </dev> <br>


                        <select style="width:120px;float:left;margin-right:10px;" name="status" class="form-control">
                            <option value="1" <eq name="Think.get.agent" value="1">selected</eq> >一级代理</option>
                            <option value="2" <eq name="Think.get.agent" value="2">selected</eq> >二级代理</option>
                            <option value="3" <eq name="Think.get.agent" value="3">selected</eq> >三级代理</option>
                            <option value="4" <eq name="Think.get.agent" value="4">selected</eq> >普通用户</option>
                            <option value="5" <empty name="Think.get.agent">selected</empty> >全部用户</option>
                        </select>
                        <select style="width:120px;float:left;margin-right:10px;" name="field" class="form-control">
                            <option value="id" <empty name="Think.get.field" value="id" >selected</empty> >UID</option>
                            <option value="username" <eq name="Think.get.field" value="username">selected</eq> >邮箱账号</option>
                            <option value="phone" <eq name="Think.get.field" value="phone">selected</eq> >手机号码</option>
                        </select>

                        <script type="text/javascript" src="/Public/layer/laydate/laydate.js"></script>

                        <input type="text" name="search" class="search-input form-control" value="{$Think.get.search}" placeholder="请输入查询内容" style="">
                        <a class="sch-btn" href="javascript:;" id="search"> <i class="btn-search"></i> </a>
                    </form>
                    <script>
                        //搜索功能
                        $(function () {
                            $('#search').click(function () {
                                $('#formSearch').submit();
                            });
                        });
                        //回车搜索
                        $(".search-input").keyup(function (e) {
                            if (e.keyCode === 13) {
                                $("#search").click();
                                return false;
                            }
                        });
                    </script>
                </div>
            </div>
        </div>
        <style>
            .count{
                float: left;
                margin-bottom: 5px;
                background: red;
                margin-left: 50px;
            }
        </style>
        <div class="main-title-h">
            <div class="count">
                <span class="h1-title">总充值</span>
                <span id="count_recharge">0.00</span>
            </div>
            <div class="count">
                <span class="h1-title">总提现</span>
                <span id="count_withdraw">0.00</span>
            </div>
            <div class="count">
                <span class="h1-title">总盈亏</span>
                <span id = "count_profit">0.00</span>
            </div>

        </div>
        <div class="data-table table-striped">
            <form id="form"  method="post" class="form-horizontal">
                <table class="">
                    <thead>
                    <tr>
                        <th class="row-selected row-selected">
                            <input class="check-all" type="checkbox"/>
                        </th>
                        <th class="">ID</th>
                        <th class="">会员账号 / 手机号</th>
                        <th class="">金额</th>
                        <th class="">上级代理</th>
                        <th class="">总充值</th>
                        <th class="">总提现</th>
                        <th class="">盈亏</th>
                        <th class="">操作</th>

                    </tr>
                    </thead>
                    <tbody>
                    <style>
                        .btn-xs, .btn-group-xs > .btn{
                            display: block;
                            margin-bottom: 5px;
                        }
                    </style>
                    <notempty name="list">
                        <volist name="list" id="vo">
                            <tr>
                                <td>
                                    <input class="ids" type="checkbox" name="id[]" value="{$vo.id}"/>
                                </td>
                                <td>{$vo.id}</td>
                                <td><span style="color: red">{$vo.username}</span> <p/> <span style="color: green">{$vo.phone}</span></td>
                                <td>
                                     <span>{$vo.coin}</span>
                                <td style="width:120px;white-space:unset">
                                    <neq name="vo.invit_1"><a href="{:U('User/index?name='.$vo['invit_1'].'&field=username')}">1代：{$vo['invit_1']}</a><br></neq>
                                    <neq name="vo.invit_2"><a href="{:U('User/index?name='.$vo['invit_2'].'&field=username')}">2代：{$vo['invit_2']}</a><br></neq>
                                    <neq name="vo.invit_3"><a href="{:U('User/index?name='.$vo['invit_3'].'&field=username')}">3代：{$vo['invit_3']}</a><br></neq>
                                </td>
                                <td>
                                    <span>{$vo.withdraw}</span>
                                </td>
                                <td><span>{$vo.recharge}</span></td>
                                <td><span>{$vo.profit}</span></td>




                                <td>
                                    <eq name="vo.is_agent" value="0">
                                        <input type="button" class="ajax-get btn btn-danger btn-xs" value="查看下级" onclick="setagent('{$vo['id']}');"/>
                                    </eq>
                                </td>


                            </tr>
                        </volist>
                        <else/>
                        <td colspan="12" class="text-center empty-info"><i class="glyphicon glyphicon-exclamation-sign"></i>暂无数据</td>
                    </notempty>
                    </tbody>
                </table>
            </form>
            <div class="page">
                <div>{$page}</div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="/Public/laydate/laydate.js"></script>
<script type="text/javascript">
    laydate.render({
        type: "datetime",
        elem: '#test-range' //开始时间和结束时间所在 input 框的父选择器
        //设置开始日期、日期日期的 input 选择器
        ,range: ['#start_time', '#end_time'] //数组格式为 layui 2.6.6 开始新增
    });
</script>';
<script type="text/javascript">
    //提交表单
    $('#submit').click(function () {
        $('#form').submit();
    });
    $(".page > div").children("a").each(function(){
        var ahref = $(this).attr('href');
        var ahrefarr = ahref.split("/");
        var ahlength = ahrefarr.length;
        var newhref = '';
        for(var i=0;i<ahlength;i++){
            if(i<3 && i>0){
                newhref += "/"+ahrefarr[i];
            }
            if(i==3){
                newhref += "/"+ahrefarr[i]+".html?";
            }
            if(i>=4 && i%2==0){
                newhref += "&"+ahrefarr[i]+"="+ahrefarr[i+1];
            }
        }
        $(this).attr("href",newhref);
    });
</script>
<include file="Public:footer" />
<script type="text/javascript">
    function setagent(id) {
        var uid = parseInt(id);
        if (uid == "" || uid == null || uid <=0) {
            layer.alert('参数错误！');
            return false;
        }
        layer.load(0, {shade: [0.5,'#8F8F8F']});
        $.post("{:U('User/setagent')}", {
            id: uid
        }, function (data) {
            setTimeout("closetanchu()",2000);
            if (data.status == 1) {
                layer.msg(data.info, {
                    icon: 1
                });
                setTimeout("shuaxin()",1000);
            } else {
                layer.msg(data.info, {
                    icon: 2
                });
            }
        }, "json");
    }

    function gdswitch(id,gd_state) {
        var uid = parseInt(id);
        if (uid == "" || uid == null || uid <=0) {
            layer.alert('参数错误！');
            return false;
        }
        layer.load(0, {shade: [0.5,'#8F8F8F']});
        $.post("{:U('User/gdswitch')}", {
            id: uid,
            gd_state: gd_state
        }, function (data) {
            setTimeout("closetanchu()",2000);
            if (data.status == 1) {
                layer.msg(data.info, {
                    icon: 1
                });
                setTimeout("shuaxin()",1000);
            } else {
                layer.msg(data.info, {
                    icon: 2
                });
            }
        }, "json");
    }

</script>
<script type="text/javascript">
    function closetanchu(){
        layer.closeAll('loading');
    }
    function shuaxin(){
        window.location.href=window.location.href;
    }
</script>
<block name="script">
    <script type="text/javascript" charset="utf-8">
        //导航高亮
        highlight_subnav("{:U('User/count')}");
    </script>
</block>


